<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>fabric - auto deployment script | Greg's Tech Notes</title>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://stencel.io/posts/fabric-auto-deployment-script.html">
<!--[if lt IE 9]><script src="../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Greg Stencel">
<link rel="prev" href="nikola-error-command-x86_64-linux-gnu-gcc-failed-with-exit-status-1.html" title="Nikola error: command 'x86_64-linux-gnu-gcc' failed with exit status 1" type="text/html">
<link rel="next" href="git-commants-ive-found-useful.html" title="GIT commants I've found useful" type="text/html">
<meta property="og:site_name" content="Greg's Tech Notes">
<meta property="og:title" content="fabric - auto deployment script">
<meta property="og:url" content="https://stencel.io/posts/fabric-auto-deployment-script.html">
<meta property="og:description" content='Recently I wrote fabric deployment scrip maybe someone will find it usefull.
It enables possibility to run "group execute" task with
fab live_servers pull restart

or single host
fab live1 pull

All w'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-11-02T14:45:29Z">
<meta property="article:tag" content="DevOps">
<meta property="article:tag" content="fabric">
</head>
<body>
    <a href="#page-content" class="sr-only sr-only-focusable">Skip to main content</a>
    
    <section class="social"><ul>
<li><p style="color:#fff;font-size:3em;">stencel.io</p></li>
        <li><p style="color:#fff;font-size:2em;">greg's tech notes</p></li>
            <li>
                <a href="https://stencel.io/">
                    <img src="../images/aboutme.png" alt="Greg's Tech Notes" id="logo"></a>
            </li>
        
            <li><a href="../index.html" title="Home"><i class="fa fa-home"></i></a></li>
            <li><a href="../archive.html" title="Archives"><i class="fa fa-folder-open"></i></a></li>
            <li><a href="../categories/index.html" title="Tags"><i class="fa fa-tags"></i></a></li>
            <li><a href="https://www.linkedin.com/in/gregstencel/" title="My Linkedin"><i class="fab fa-linkedin"></i></a></li>
            <li><a href="https://github.com/greg4fun" title="My Github"><i class="fab fa-github"></i></a></li>
    
    

        </ul></section><section class="page-content"><div class="content" rel="main">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">fabric - auto deployment script</a></h1>

        <div class="metadata">
            <p class="dateline"><a href="#" rel="bookmark"><i class="fa fa-clock"></i> <time class="published dt-published" datetime="2016-11-02T14:45:29Z" itemprop="datePublished" title="2016-11-02 14:45">2016-11-02 14:45</time></a></p>
            <p class="byline author vcard"> <i class="fa fa-user"></i> <span class="byline-name fn" itemprop="author">
                    Greg Stencel
            </span></p>
                <p class="commentline"><i class="far fa-comment"></i>
    
    <a href="fabric-auto-deployment-script.html#disqus_thread" data-disqus-identifier="cache/posts/fabric-auto-deployment-script.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="fabric-auto-deployment-script.rst" class="sourcelink"><i class="fa fa-file-code"></i> Source</a></p>

            

            
    <div class="tags">
<h3 class="metadata-title">
<i class="fa fa-tags"></i> Tags:</h3>
        <ul itemprop="keywords" class="tags-ul">
<li><a class="tag p-category" href="../categories/devops.html" rel="tag">DevOps</a></li>
            <li><a class="tag p-category" href="../categories/fabric.html" rel="tag">fabric</a></li>
        </ul>
</div>

        </div>
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Recently I wrote fabric deployment scrip maybe someone will find it usefull.</p>
<p>It enables possibility to run "group execute" task with</p>
<div class="code"><pre class="code python"><a id="rest_code_950191822ebd4961a83a488a73593d7d-1" name="rest_code_950191822ebd4961a83a488a73593d7d-1" href="fabric-auto-deployment-script.html#rest_code_950191822ebd4961a83a488a73593d7d-1"></a><span class="n">fab</span> <span class="n">live_servers</span> <span class="n">pull</span> <span class="n">restart</span>
</pre></div>
<p>or single host</p>
<div class="code"><pre class="code python"><a id="rest_code_29fb542a372f4dd3bfe4717ba330b648-1" name="rest_code_29fb542a372f4dd3bfe4717ba330b648-1" href="fabric-auto-deployment-script.html#rest_code_29fb542a372f4dd3bfe4717ba330b648-1"></a><span class="n">fab</span> <span class="n">live1</span> <span class="n">pull</span>
</pre></div>
<p>All we need to do is to define group or sinle host as function afterwards I used end update decorator.</p>
<p>I know there could be also something like duplication of tasks with separate servers fab live1 pull live2
pull but I believe that fabric was written for distributed systems which has different paths of apps and users
etc.</p>
<p>also roledefs with extra dict keys didn't work for me)? I want to keep this simple single/multiple host
deployment commands like : fab live_servers pull, fab test pull</p>
<div class="code"><pre class="code python"><a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-1" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-1" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-1"></a><span class="kn">from</span> <span class="nn">fabric.api</span> <span class="kn">import</span> <span class="n">run</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">cd</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-2" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-2" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-2"></a><span class="kn">from</span> <span class="nn">fabric.tasks</span> <span class="kn">import</span> <span class="n">execute</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-3" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-3" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-3"></a><span class="kn">import</span> <span class="nn">inspect</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-4" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-4" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-4"></a><span class="kn">import</span> <span class="nn">sys</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-5" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-5" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-5"></a><span class="kn">import</span> <span class="nn">os</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-6" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-6" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-6"></a><span class="kn">import</span> <span class="nn">re</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-7" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-7" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-7"></a><span class="kn">from</span> <span class="nn">StringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-8" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-8" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-8"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-9" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-9" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-9"></a><span class="c1"># fabfile author: Grzegorz Stencel</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-10" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-10" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-10"></a><span class="c1"># usage:</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-11" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-11" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-11"></a><span class="c1"># run: fab help for examples</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-12" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-12" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-12"></a><span class="c1"># fab staging svnxapp:app=holdings_and_quotes,layout.py,permissions.py restart</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-13" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-13" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-13"></a><span class="c1"># fab test svnxlib</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-14" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-14" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-14"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-15" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-15" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-15"></a><span class="n">SERVER_BRANCHES</span> <span class="o">=</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-16" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-16" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-16"></a>    <span class="s1">'live'</span><span class="p">:</span> <span class="s1">'master'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-17" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-17" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-17"></a>    <span class="s1">'sit'</span><span class="p">:</span> <span class="s1">'sit'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-18" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-18" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-18"></a>    <span class="s1">'uat'</span><span class="p">:</span> <span class="s1">'uat'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-19" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-19" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-19"></a>    <span class="s1">'live2'</span><span class="p">:</span><span class="s1">'master'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-20" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-20" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-20"></a>    <span class="s1">'live3'</span><span class="p">:</span><span class="s1">'master'</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-21" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-21" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-21"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-22" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-22" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-22"></a><span class="p">}</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-23" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-23" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-23"></a><span class="c1"># MAIN CONF</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-24" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-24" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-24"></a><span class="n">SERVERS</span> <span class="o">=</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-25" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-25" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-25"></a>    <span class="s1">'local'</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-26" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-26" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-26"></a>        <span class="s1">'envname'</span><span class="p">:</span> <span class="s1">'local'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-27" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-27" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-27"></a>        <span class="s1">'user'</span><span class="p">:</span> <span class="s1">'greg'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-28" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-28" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-28"></a>        <span class="s1">'host'</span><span class="p">:</span> <span class="s1">'localhost'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-29" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-29" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-29"></a>        <span class="s1">'host_string'</span><span class="p">:</span> <span class="s1">'localhost'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-30" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-30" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-30"></a>        <span class="s1">'path'</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'SITE_ROOT'</span><span class="p">,</span> <span class="s1">'/opt/myapp/test'</span><span class="p">),</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-31" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-31" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-31"></a>        <span class="s1">'www_root'</span><span class="p">:</span> <span class="s1">'http://localhost:8081/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-32" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-32" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-32"></a>        <span class="s1">'retries_before_killing'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-33" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-33" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-33"></a>        <span class="s1">'retry_sleep'</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-34" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-34" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-34"></a>    <span class="p">},</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-35" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-35" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-35"></a>    <span class="s1">'test'</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-36" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-36" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-36"></a>        <span class="s1">'envname'</span><span class="p">:</span> <span class="s1">'test'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-37" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-37" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-37"></a>        <span class="s1">'user'</span><span class="p">:</span> <span class="s1">'root'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-38" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-38" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-38"></a>        <span class="s1">'host'</span><span class="p">:</span> <span class="s1">'myapp-test.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-39" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-39" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-39"></a>        <span class="s1">'host_string'</span><span class="p">:</span> <span class="s1">'myapp-test.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-40" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-40" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-40"></a>        <span class="s1">'path'</span><span class="p">:</span> <span class="s1">'/var/www/myapp/test/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-41" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-41" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-41"></a>        <span class="s1">'www_root'</span><span class="p">:</span> <span class="s1">'http://myapp-test.stencel.com/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-42" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-42" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-42"></a>        <span class="s1">'retries_before_killing'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-43" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-43" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-43"></a>        <span class="s1">'retry_sleep'</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-44" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-44" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-44"></a>    <span class="p">},</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-45" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-45" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-45"></a>    <span class="s1">'uat'</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-46" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-46" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-46"></a>        <span class="s1">'envname'</span><span class="p">:</span> <span class="s1">'uat'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-47" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-47" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-47"></a>        <span class="s1">'user'</span><span class="p">:</span> <span class="s1">'myapp'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-48" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-48" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-48"></a>        <span class="s1">'host'</span><span class="p">:</span> <span class="s1">'uat.myapp2.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-49" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-49" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-49"></a>        <span class="s1">'host_string'</span><span class="p">:</span> <span class="s1">'uat.myapp2.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-50" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-50" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-50"></a>        <span class="s1">'key_filename'</span><span class="p">:</span> <span class="s1">'deploy/keys/id_rsa'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-51" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-51" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-51"></a>        <span class="s1">'path'</span><span class="p">:</span> <span class="s1">'/opt/myapp/uat/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-52" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-52" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-52"></a>        <span class="s1">'www_root'</span><span class="p">:</span> <span class="s1">'http://uat.myapp2.stencel.com/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-53" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-53" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-53"></a>        <span class="s1">'retries_before_killing'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-54" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-54" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-54"></a>        <span class="s1">'retry_sleep'</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-55" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-55" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-55"></a>    <span class="p">},</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-56" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-56" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-56"></a>    <span class="s1">'sit'</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-57" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-57" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-57"></a>        <span class="s1">'envname'</span><span class="p">:</span> <span class="s1">'sit'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-58" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-58" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-58"></a>        <span class="s1">'user'</span><span class="p">:</span> <span class="s1">'myapp'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-59" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-59" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-59"></a>        <span class="s1">'host'</span><span class="p">:</span> <span class="s1">'sit.myapp2.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-60" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-60" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-60"></a>        <span class="s1">'host_string'</span><span class="p">:</span> <span class="s1">'sit.myapp2.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-61" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-61" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-61"></a>        <span class="s1">'key_filename'</span><span class="p">:</span> <span class="s1">'deploy/keys/id_rsa'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-62" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-62" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-62"></a>        <span class="s1">'path'</span><span class="p">:</span> <span class="s1">'/opt/myapp/sit/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-63" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-63" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-63"></a>        <span class="s1">'www_root'</span><span class="p">:</span> <span class="s1">'http://sit.myapp2.stencel.com/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-64" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-64" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-64"></a>        <span class="s1">'retries_before_killing'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-65" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-65" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-65"></a>        <span class="s1">'retry_sleep'</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-66" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-66" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-66"></a>    <span class="p">},</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-67" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-67" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-67"></a>    <span class="s1">'live'</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-68" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-68" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-68"></a>        <span class="s1">'envname'</span><span class="p">:</span> <span class="s1">'live'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-69" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-69" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-69"></a>        <span class="s1">'user'</span><span class="p">:</span> <span class="s1">'myapp'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-70" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-70" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-70"></a>        <span class="s1">'host'</span><span class="p">:</span> <span class="s1">'10.10.10.10'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-71" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-71" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-71"></a>        <span class="s1">'host_string'</span><span class="p">:</span> <span class="s1">'myapp2.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-72" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-72" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-72"></a>        <span class="s1">'path'</span><span class="p">:</span> <span class="s1">'/opt/myapp/live/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-73" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-73" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-73"></a>        <span class="s1">'www_root'</span><span class="p">:</span> <span class="s1">'http://myapp2.stencel.com/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-74" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-74" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-74"></a>        <span class="s1">'retries_before_killing'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-75" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-75" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-75"></a>        <span class="s1">'retry_sleep'</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-76" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-76" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-76"></a>    <span class="p">},</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-77" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-77" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-77"></a>    <span class="s1">'live2'</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-78" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-78" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-78"></a>        <span class="s1">'envname'</span><span class="p">:</span> <span class="s1">'live2'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-79" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-79" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-79"></a>        <span class="s1">'user'</span><span class="p">:</span> <span class="s1">'root'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-80" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-80" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-80"></a>        <span class="s1">'host'</span><span class="p">:</span> <span class="s1">'10.10.10.11'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-81" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-81" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-81"></a>        <span class="s1">'host_string'</span><span class="p">:</span> <span class="s1">'live2.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-82" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-82" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-82"></a>        <span class="s1">'path'</span><span class="p">:</span> <span class="s1">'/var/www/myapp/live/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-83" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-83" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-83"></a>        <span class="s1">'www_root'</span><span class="p">:</span> <span class="s1">'http://myapp2.stencel.com/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-84" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-84" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-84"></a>        <span class="s1">'retries_before_killing'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-85" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-85" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-85"></a>        <span class="s1">'retry_sleep'</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-86" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-86" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-86"></a>    <span class="p">},</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-87" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-87" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-87"></a>    <span class="s1">'live3'</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-88" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-88" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-88"></a>        <span class="s1">'envname'</span><span class="p">:</span> <span class="s1">'live3'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-89" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-89" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-89"></a>        <span class="s1">'user'</span><span class="p">:</span> <span class="s1">'root'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-90" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-90" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-90"></a>        <span class="s1">'host'</span><span class="p">:</span> <span class="s1">'10.10.10.12'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-91" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-91" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-91"></a>        <span class="s1">'host_string'</span><span class="p">:</span> <span class="s1">'live3.stencel.com'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-92" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-92" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-92"></a>        <span class="s1">'path'</span><span class="p">:</span> <span class="s1">'/var/www/myapp/live/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-93" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-93" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-93"></a>        <span class="s1">'www_root'</span><span class="p">:</span> <span class="s1">'http://myapp2.stencel.com/'</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-94" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-94" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-94"></a>        <span class="s1">'retries_before_killing'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-95" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-95" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-95"></a>        <span class="s1">'retry_sleep'</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-96" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-96" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-96"></a>    <span class="p">},</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-97" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-97" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-97"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-98" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-98" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-98"></a><span class="p">}</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-99" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-99" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-99"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-100" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-100" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-100"></a><span class="n">LIVE_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'live'</span><span class="p">,</span> <span class="s1">'live2'</span><span class="p">,</span> <span class="s1">'live3'</span><span class="p">]</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-101" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-101" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-101"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-102" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-102" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-102"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-103" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-103" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-103"></a><span class="k">def</span> <span class="nf">list_hosts</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-104" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-104" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-104"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-105" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-105" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-105"></a><span class="sd">    Lists available myapp hosts</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-106" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-106" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-106"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-107" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-107" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-107"></a>    <span class="nb">print</span> <span class="s2">" Single hosts(if you want to pull from svn only to one of them):"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-108" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-108" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-108"></a>    <span class="nb">print</span> <span class="s1">'   </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">   '</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">SERVERS</span><span class="p">])</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-109" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-109" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-109"></a>    <span class="nb">print</span> <span class="s2">" Multiple hosts"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-110" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-110" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-110"></a>    <span class="nb">print</span> <span class="s1">'   live (which contains </span><span class="si">%s</span><span class="s1">)'</span> <span class="o">%</span> <span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">LIVE_HOSTS</span><span class="p">])</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-111" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-111" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-111"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-112" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-112" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-112"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-113" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-113" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-113"></a><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-114" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-114" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-114"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-115" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-115" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-115"></a><span class="sd">    single host definition , "fab test restart" wil restart this one host</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-116" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-116" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-116"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-117" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-117" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-117"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-118" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-118" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-118"></a>    <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="s1">'test'</span><span class="p">]))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-119" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-119" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-119"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-120" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-120" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-120"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-121" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-121" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-121"></a><span class="k">def</span> <span class="nf">localhost</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-122" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-122" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-122"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-123" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-123" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-123"></a><span class="sd">    single host definition , "fab test restart" wil restart this one host</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-124" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-124" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-124"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-125" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-125" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-125"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-126" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-126" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-126"></a>    <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="s1">'local'</span><span class="p">]))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-127" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-127" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-127"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-128" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-128" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-128"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-129" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-129" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-129"></a><span class="k">def</span> <span class="nf">uat</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-130" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-130" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-130"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-131" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-131" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-131"></a><span class="sd">    single host definition , "fab uat restart" wil restart this single host</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-132" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-132" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-132"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-133" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-133" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-133"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-134" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-134" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-134"></a>    <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="s1">'uat'</span><span class="p">]))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-135" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-135" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-135"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-136" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-136" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-136"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-137" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-137" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-137"></a><span class="k">def</span> <span class="nf">sit</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-138" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-138" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-138"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-139" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-139" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-139"></a><span class="sd">    single host</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-140" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-140" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-140"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-141" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-141" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-141"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-142" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-142" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-142"></a>    <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="s1">'sit'</span><span class="p">]))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-143" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-143" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-143"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-144" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-144" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-144"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-145" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-145" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-145"></a><span class="c1">#  SERVERS GRcompanyS DEFINITION</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-146" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-146" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-146"></a><span class="k">def</span> <span class="nf">live</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-147" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-147" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-147"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-148" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-148" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-148"></a><span class="sd">    multiple grcompany of hosts - running: "fab live restart" will restart all live servers</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-149" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-149" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-149"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-150" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-150" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-150"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-151" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-151" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-151"></a>    <span class="n">env</span><span class="p">[</span><span class="s1">'hosts'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">SERVERS</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">LIVE_HOSTS</span><span class="p">]</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-152" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-152" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-152"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-153" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-153" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-153"></a>    <span class="c1"># env.update(dict(SERVERS['staging']))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-154" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-154" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-154"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-155" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-155" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-155"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-156" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-156" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-156"></a><span class="k">def</span> <span class="nf">env_update</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-157" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-157" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-157"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-158" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-158" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-158"></a><span class="sd">    Decorator - needs to be added to each task in fabricfile - for multiple host task execution</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-159" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-159" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-159"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-160" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-160" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-160"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-161" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-161" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-161"></a>    <span class="k">def</span> <span class="nf">func_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-162" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-162" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-162"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">hosts</span><span class="p">):</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-163" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-163" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-163"></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-164" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-164" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-164"></a>        <span class="k">else</span><span class="p">:</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-165" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-165" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-165"></a>            <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">SERVERS</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">'host'</span><span class="p">]</span> <span class="o">==</span> <span class="n">env</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">MyApp_SERVERS</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-166" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-166" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-166"></a>            <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-167" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-167" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-167"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-168" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-168" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-168"></a>    <span class="k">return</span> <span class="n">func_wrapper</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-169" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-169" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-169"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-170" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-170" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-170"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-171" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-171" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-171"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-172" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-172" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-172"></a><span class="k">def</span> <span class="nf">bundle_media</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-173" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-173" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-173"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-174" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-174" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-174"></a><span class="sd">    bundles media like css and js to one file.</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-175" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-175" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-175"></a><span class="sd">    example:</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-176" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-176" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-176"></a><span class="sd">        fab test bundle_media</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-177" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-177" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-177"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-178" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-178" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-178"></a>    <span class="c1"># export DJANGO_SETTINGS_MODULE=settings</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-179" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-179" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-179"></a>    <span class="c1">#run("cd {0} &amp;&amp; source settings/{1}-config.sh &amp;&amp; python scripts/bundle_media.py".format(env.path,env.envname))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-180" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-180" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-180"></a>   <span class="n">run</span><span class="p">(</span><span class="s2">"source /usr/share/virtualenvwrapper/virtualenvwrapper.sh &amp;&amp; workon </span><span class="si">{0}</span><span class="s2"> &amp;&amp; python scripts/bundle_media.py"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">-myapp"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span> <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">&lt;&gt;</span> <span class="s1">'live'</span> <span class="k">else</span> <span class="s1">'MyApp-test'</span><span class="p">))</span> <span class="c1">#change live venv to be live-MyApp</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-181" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-181" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-181"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-182" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-182" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-182"></a><span class="k">def</span> <span class="nf">_valid_branch</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-183" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-183" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-183"></a>    <span class="n">branch</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="s2">"cd </span><span class="si">{0}</span><span class="s2"> &amp;&amp; git rev-parse --abbrev-ref HEAD"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-184" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-184" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-184"></a>    <span class="k">return</span> <span class="n">branch</span> <span class="o">==</span> <span class="n">SERVER_BRANCHES</span><span class="p">[</span><span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">==</span><span class="s1">'local'</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-185" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-185" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-185"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-186" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-186" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-186"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-187" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-187" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-187"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-188" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-188" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-188"></a><span class="k">def</span> <span class="nf">pull</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-189" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-189" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-189"></a>    <span class="k">if</span> <span class="n">_valid_branch</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-190" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-190" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-190"></a>        <span class="k">with</span> <span class="n">cd</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-191" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-191" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-191"></a>            <span class="n">run</span><span class="p">(</span><span class="s2">"git fetch origin"</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-192" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-192" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-192"></a>            <span class="n">run</span><span class="p">(</span><span class="s2">"git reset --hard origin/</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">branch</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-193" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-193" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-193"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-194" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-194" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-194"></a>        <span class="nb">print</span> <span class="s2">"Error : Server is checked out to wrong branch!!!"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-195" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-195" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-195"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-196" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-196" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-196"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-197" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-197" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-197"></a>            <span class="c1">#run('git fetch --quiet')</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-198" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-198" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-198"></a>            <span class="c1">#run('git fetch --tags --quiet')</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-199" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-199" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-199"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-200" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-200" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-200"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-201" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-201" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-201"></a><span class="k">def</span> <span class="nf">reload</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-202" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-202" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-202"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-203" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-203" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-203"></a><span class="sd">    Reload specified servers - kills unused gunicorn workers but waits workers with old code to finish processing.</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-204" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-204" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-204"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-205" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-205" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-205"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-206" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-206" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-206"></a>    <span class="n">bundle_media</span><span class="p">()</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-207" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-207" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-207"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-208" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-208" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-208"></a>    <span class="c1">#if env.envname in ('uat', 'staging', 'live'):</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-209" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-209" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-209"></a>    <span class="n">f</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-210" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-210" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-210"></a>    <span class="n">get</span><span class="p">(</span><span class="s2">"/opt/myapp/</span><span class="si">%s</span><span class="s2">/pid"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-211" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-211" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-211"></a>    <span class="n">pid</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">'\d+'</span><span class="p">,</span><span class="n">f</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-212" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-212" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-212"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"ps aux | grep gunicorn | grep </span><span class="si">%s</span><span class="s2"> | grep master | grep -v grep | awk '{print $2}'"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-213" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-213" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-213"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"kill -HUP </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">pid</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-214" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-214" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-214"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-215" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-215" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-215"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-216" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-216" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-216"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-217" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-217" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-217"></a><span class="k">def</span> <span class="nf">restart</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-218" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-218" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-218"></a>    <span class="sd">"""</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-219" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-219" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-219"></a><span class="sd">    Hard restarts specified servers</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-220" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-220" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-220"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-221" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-221" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-221"></a><span class="sd">    """</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-222" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-222" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-222"></a>    <span class="n">bundle_media</span><span class="p">()</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-223" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-223" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-223"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"ps aux | grep gunicorn | grep </span><span class="si">%s</span><span class="s2"> | grep master | grep -v grep | awk '{print $2}'"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-224" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-224" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-224"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"supervisorctl stop myapp-</span><span class="si">%s</span><span class="s2"> &amp;&amp; supervisorctl start MyApp-</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">,</span><span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">))</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-225" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-225" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-225"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"ps aux | grep gunicorn | grep </span><span class="si">%s</span><span class="s2"> | grep master | grep -v grep | awk '{print $2}'"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-226" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-226" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-226"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-227" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-227" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-227"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-228" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-228" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-228"></a><span class="k">def</span> <span class="nf">help</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-229" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-229" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-229"></a>    <span class="n">fabric_functions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'run'</span><span class="p">,</span> <span class="s1">'execute'</span><span class="p">,</span> <span class="s1">'local'</span><span class="p">,</span> <span class="s1">'func_wrapper'</span><span class="p">]</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-230" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-230" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-230"></a>    <span class="n">functions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fabric_functions</span> <span class="k">else</span> <span class="s1">''</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-231" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-231" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-231"></a>                     <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">])</span> <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">obj</span><span class="p">)])</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-232" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-232" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-232"></a>    <span class="n">functions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-233" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-233" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-233"></a>    <span class="nb">print</span> <span class="s2">"usage: </span><span class="se">\n</span><span class="s2">  fab [host/grcompany of hosts] [commands] (optional command with arguments command:kwarg=val,arg1,arg2,arg3)"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-234" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-234" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-234"></a>    <span class="nb">print</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">available servers:"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-235" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-235" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-235"></a>    <span class="n">list_hosts</span><span class="p">()</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-236" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-236" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-236"></a>    <span class="nb">print</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">commands:</span><span class="se">\n</span><span class="s2">  </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">])</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-237" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-237" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-237"></a>    <span class="nb">print</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">examples:</span><span class="se">\n</span><span class="s2">  staging svnxapp:app=holdings_and_quotes,layout.py,permissions.py restart"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-238" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-238" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-238"></a>    <span class="nb">print</span> <span class="s2">"  fab test restart"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-239" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-239" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-239"></a>    <span class="nb">print</span> <span class="s2">"  fab staging svnxapp:app=holdings_and_quotes,lib/quote.py,layout.py,models.py"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-240" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-240" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-240"></a>    <span class="nb">print</span> <span class="s2">"  fab staging svnxapp:app=holdings_and_quotes,lib/quote.py restart"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-241" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-241" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-241"></a>    <span class="nb">print</span> <span class="s2">"  fab test build"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-242" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-242" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-242"></a>    <span class="nb">print</span> <span class="s2">"  fab test bundle_media restart"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-243" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-243" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-243"></a>    <span class="nb">print</span> <span class="s2">" For svnx whole app (comma in the end):"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-244" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-244" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-244"></a>    <span class="nb">print</span> <span class="s2">"  fab test svnxapp:app=medrep,"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-245" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-245" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-245"></a>    <span class="nb">print</span> <span class="s2">" For global lib:"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-246" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-246" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-246"></a>    <span class="nb">print</span> <span class="s2">"  fab test svnxlib"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-247" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-247" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-247"></a>    <span class="nb">print</span> <span class="s2">" For whole global media:"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-248" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-248" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-248"></a>    <span class="nb">print</span> <span class="s2">"  fab test svnxmedia:"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-249" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-249" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-249"></a>    <span class="nb">print</span> <span class="s2">" For global media file:"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-250" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-250" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-250"></a>    <span class="nb">print</span> <span class="s2">"  fab test svnxmedia:javascript"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-251" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-251" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-251"></a>    <span class="nb">print</span> <span class="s2">"  fab test svnxmedia:javascript/company/checklist.js"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-252" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-252" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-252"></a>    <span class="nb">print</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">If .js file in args like : fab staging svnxapp:app=holdings_and_quotes,media/js/quote.js,layout.py,models.py"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-253" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-253" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-253"></a>    <span class="nb">print</span> <span class="s2">"It will bundle media itself"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-254" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-254" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-254"></a>    <span class="nb">print</span> <span class="s2">"Restart test staging without params:</span><span class="se">\n</span><span class="s2">  fab restart"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-255" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-255" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-255"></a>    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-256" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-256" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-256"></a>        <span class="nb">print</span> <span class="n">f</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-257" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-257" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-257"></a>        <span class="nb">print</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="vm">__doc__</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-258" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-258" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-258"></a>        <span class="nb">print</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-259" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-259" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-259"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-260" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-260" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-260"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-261" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-261" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-261"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-262" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-262" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-262"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-263" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-263" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-263"></a><span class="k">def</span> <span class="nf">accessguni</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-264" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-264" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-264"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"tail /var/log/myapp/access-</span><span class="si">%s</span><span class="s2">.log"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-265" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-265" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-265"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-266" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-266" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-266"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-267" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-267" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-267"></a><span class="k">def</span> <span class="nf">accessgunilive</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-268" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-268" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-268"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"tail -f /var/log/myapp/access-</span><span class="si">%s</span><span class="s2">.log"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-269" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-269" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-269"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-270" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-270" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-270"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-271" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-271" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-271"></a><span class="k">def</span> <span class="nf">errorguni</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-272" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-272" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-272"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"tail /var/log/myapp/error-</span><span class="si">%s</span><span class="s2">.log"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-273" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-273" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-273"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-274" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-274" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-274"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-275" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-275" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-275"></a><span class="k">def</span> <span class="nf">errorgunilive</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-276" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-276" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-276"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">"tail -f /var/log/myapp/error.log"</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-277" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-277" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-277"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-278" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-278" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-278"></a><span class="k">def</span> <span class="nf">hostname</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-279" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-279" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-279"></a>    <span class="n">run</span><span class="p">(</span><span class="s1">'uname -a'</span><span class="p">)</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-280" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-280" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-280"></a>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-281" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-281" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-281"></a><span class="nd">@env_update</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-282" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-282" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-282"></a><span class="k">def</span> <span class="nf">uptime</span><span class="p">():</span>
<a id="rest_code_f156e956ff6a4dbba9de314cd57dc702-283" name="rest_code_f156e956ff6a4dbba9de314cd57dc702-283" href="fabric-auto-deployment-script.html#rest_code_f156e956ff6a4dbba9de314cd57dc702-283"></a>    <span class="n">run</span><span class="p">(</span><span class="s1">'uptime'</span><span class="p">)</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="nikola-error-command-x86_64-linux-gnu-gcc-failed-with-exit-status-1.html" rel="prev" title="Nikola error: command 'x86_64-linux-gnu-gcc' failed with exit status 1">Previous post</a>
            </li>
            <li class="next">
                <a href="git-commants-ive-found-useful.html" rel="next" title="GIT commants I've found useful">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="stencel",
            disqus_url="https://stencel.io/posts/fabric-auto-deployment-script.html",
        disqus_title="fabric - auto deployment script",
        disqus_identifier="cache/posts/fabric-auto-deployment-script.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="stencel";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents  2023         <a href="mailto:gstencel@gmail.com">Greg Stencel</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50641127-1', 'stencel.io');
  ga('send', 'pageview');

</script><script type="text/javascript" src="../assets/js/tipuesearch_set.js"></script><script type="text/javascript" src="../assets/js/tipuesearch.js"></script><script type="text/javascript">
$(document).ready(function() {
     $('#tipue_search_input').tipuesearch({
         'mode': 'json',
         'contentLocation': '/assets/js/tipuesearch_content.json',
         'showUrl': false
     });
});
</script>
</body>
</html>
