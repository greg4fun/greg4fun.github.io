<p>Recently I wrote fabric deployment scrip maybe someone will find it usefull.</p>
<p>It enables possibility to run &quot;group execute&quot; task with</p>
<div class="code"><pre class="code python"><a id="rest_code_a103529d98e345a3abed324dfa64e798-1" name="rest_code_a103529d98e345a3abed324dfa64e798-1" href="#rest_code_a103529d98e345a3abed324dfa64e798-1"></a><span class="n">fab</span> <span class="n">live_servers</span> <span class="n">pull</span> <span class="n">restart</span>
</pre></div>
<p>or single host</p>
<div class="code"><pre class="code python"><a id="rest_code_ca9cf2e1fc4d41149daf54b93da6daba-1" name="rest_code_ca9cf2e1fc4d41149daf54b93da6daba-1" href="#rest_code_ca9cf2e1fc4d41149daf54b93da6daba-1"></a><span class="n">fab</span> <span class="n">live1</span> <span class="n">pull</span>
</pre></div>
<p>All we need to do is to define group or sinle host as function afterwards I used end update decorator.</p>
<p>I know there could be also something like duplication of tasks with separate servers fab live1 pull live2
pull but I believe that fabric was written for distributed systems which has different paths of apps and users
etc.</p>
<p>also roledefs with extra dict keys didn't work for me)? I want to keep this simple single/multiple host
deployment commands like : fab live_servers pull, fab test pull</p>
<div class="code"><pre class="code python"><a id="rest_code_dff475444e7244c8ba4ad238bb24105c-1" name="rest_code_dff475444e7244c8ba4ad238bb24105c-1" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fabric.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">run</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">cd</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-2" name="rest_code_dff475444e7244c8ba4ad238bb24105c-2" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fabric.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">execute</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-3" name="rest_code_dff475444e7244c8ba4ad238bb24105c-3" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-4" name="rest_code_dff475444e7244c8ba4ad238bb24105c-4" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-5" name="rest_code_dff475444e7244c8ba4ad238bb24105c-5" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-6" name="rest_code_dff475444e7244c8ba4ad238bb24105c-6" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-7" name="rest_code_dff475444e7244c8ba4ad238bb24105c-7" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">StringIO</span><span class="w"> </span><span class="kn">import</span> <span class="n">StringIO</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-8" name="rest_code_dff475444e7244c8ba4ad238bb24105c-8" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-8"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-9" name="rest_code_dff475444e7244c8ba4ad238bb24105c-9" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-9"></a><span class="c1"># fabfile author: Grzegorz Stencel</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-10" name="rest_code_dff475444e7244c8ba4ad238bb24105c-10" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-10"></a><span class="c1"># usage:</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-11" name="rest_code_dff475444e7244c8ba4ad238bb24105c-11" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-11"></a><span class="c1"># run: fab help for examples</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-12" name="rest_code_dff475444e7244c8ba4ad238bb24105c-12" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-12"></a><span class="c1"># fab staging svnxapp:app=holdings_and_quotes,layout.py,permissions.py restart</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-13" name="rest_code_dff475444e7244c8ba4ad238bb24105c-13" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-13"></a><span class="c1"># fab test svnxlib</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-14" name="rest_code_dff475444e7244c8ba4ad238bb24105c-14" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-14"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-15" name="rest_code_dff475444e7244c8ba4ad238bb24105c-15" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-15"></a><span class="n">SERVER_BRANCHES</span> <span class="o">=</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-16" name="rest_code_dff475444e7244c8ba4ad238bb24105c-16" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-16"></a>    <span class="s1">&#39;live&#39;</span><span class="p">:</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-17" name="rest_code_dff475444e7244c8ba4ad238bb24105c-17" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-17"></a>    <span class="s1">&#39;sit&#39;</span><span class="p">:</span> <span class="s1">&#39;sit&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-18" name="rest_code_dff475444e7244c8ba4ad238bb24105c-18" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-18"></a>    <span class="s1">&#39;uat&#39;</span><span class="p">:</span> <span class="s1">&#39;uat&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-19" name="rest_code_dff475444e7244c8ba4ad238bb24105c-19" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-19"></a>    <span class="s1">&#39;live2&#39;</span><span class="p">:</span><span class="s1">&#39;master&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-20" name="rest_code_dff475444e7244c8ba4ad238bb24105c-20" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-20"></a>    <span class="s1">&#39;live3&#39;</span><span class="p">:</span><span class="s1">&#39;master&#39;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-21" name="rest_code_dff475444e7244c8ba4ad238bb24105c-21" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-21"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-22" name="rest_code_dff475444e7244c8ba4ad238bb24105c-22" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-22"></a><span class="p">}</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-23" name="rest_code_dff475444e7244c8ba4ad238bb24105c-23" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-23"></a><span class="c1"># MAIN CONF</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-24" name="rest_code_dff475444e7244c8ba4ad238bb24105c-24" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-24"></a><span class="n">SERVERS</span> <span class="o">=</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-25" name="rest_code_dff475444e7244c8ba4ad238bb24105c-25" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-25"></a>    <span class="s1">&#39;local&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-26" name="rest_code_dff475444e7244c8ba4ad238bb24105c-26" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-26"></a>        <span class="s1">&#39;envname&#39;</span><span class="p">:</span> <span class="s1">&#39;local&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-27" name="rest_code_dff475444e7244c8ba4ad238bb24105c-27" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-27"></a>        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;greg&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-28" name="rest_code_dff475444e7244c8ba4ad238bb24105c-28" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-28"></a>        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-29" name="rest_code_dff475444e7244c8ba4ad238bb24105c-29" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-29"></a>        <span class="s1">&#39;host_string&#39;</span><span class="p">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-30" name="rest_code_dff475444e7244c8ba4ad238bb24105c-30" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-30"></a>        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SITE_ROOT&#39;</span><span class="p">,</span> <span class="s1">&#39;/opt/myapp/test&#39;</span><span class="p">),</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-31" name="rest_code_dff475444e7244c8ba4ad238bb24105c-31" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-31"></a>        <span class="s1">&#39;www_root&#39;</span><span class="p">:</span> <span class="s1">&#39;http://localhost:8081/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-32" name="rest_code_dff475444e7244c8ba4ad238bb24105c-32" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-32"></a>        <span class="s1">&#39;retries_before_killing&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-33" name="rest_code_dff475444e7244c8ba4ad238bb24105c-33" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-33"></a>        <span class="s1">&#39;retry_sleep&#39;</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-34" name="rest_code_dff475444e7244c8ba4ad238bb24105c-34" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-34"></a>    <span class="p">},</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-35" name="rest_code_dff475444e7244c8ba4ad238bb24105c-35" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-35"></a>    <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-36" name="rest_code_dff475444e7244c8ba4ad238bb24105c-36" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-36"></a>        <span class="s1">&#39;envname&#39;</span><span class="p">:</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-37" name="rest_code_dff475444e7244c8ba4ad238bb24105c-37" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-37"></a>        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-38" name="rest_code_dff475444e7244c8ba4ad238bb24105c-38" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-38"></a>        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myapp-test.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-39" name="rest_code_dff475444e7244c8ba4ad238bb24105c-39" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-39"></a>        <span class="s1">&#39;host_string&#39;</span><span class="p">:</span> <span class="s1">&#39;myapp-test.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-40" name="rest_code_dff475444e7244c8ba4ad238bb24105c-40" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-40"></a>        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/www/myapp/test/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-41" name="rest_code_dff475444e7244c8ba4ad238bb24105c-41" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-41"></a>        <span class="s1">&#39;www_root&#39;</span><span class="p">:</span> <span class="s1">&#39;http://myapp-test.stencel.com/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-42" name="rest_code_dff475444e7244c8ba4ad238bb24105c-42" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-42"></a>        <span class="s1">&#39;retries_before_killing&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-43" name="rest_code_dff475444e7244c8ba4ad238bb24105c-43" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-43"></a>        <span class="s1">&#39;retry_sleep&#39;</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-44" name="rest_code_dff475444e7244c8ba4ad238bb24105c-44" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-44"></a>    <span class="p">},</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-45" name="rest_code_dff475444e7244c8ba4ad238bb24105c-45" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-45"></a>    <span class="s1">&#39;uat&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-46" name="rest_code_dff475444e7244c8ba4ad238bb24105c-46" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-46"></a>        <span class="s1">&#39;envname&#39;</span><span class="p">:</span> <span class="s1">&#39;uat&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-47" name="rest_code_dff475444e7244c8ba4ad238bb24105c-47" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-47"></a>        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;myapp&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-48" name="rest_code_dff475444e7244c8ba4ad238bb24105c-48" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-48"></a>        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;uat.myapp2.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-49" name="rest_code_dff475444e7244c8ba4ad238bb24105c-49" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-49"></a>        <span class="s1">&#39;host_string&#39;</span><span class="p">:</span> <span class="s1">&#39;uat.myapp2.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-50" name="rest_code_dff475444e7244c8ba4ad238bb24105c-50" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-50"></a>        <span class="s1">&#39;key_filename&#39;</span><span class="p">:</span> <span class="s1">&#39;deploy/keys/id_rsa&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-51" name="rest_code_dff475444e7244c8ba4ad238bb24105c-51" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-51"></a>        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;/opt/myapp/uat/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-52" name="rest_code_dff475444e7244c8ba4ad238bb24105c-52" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-52"></a>        <span class="s1">&#39;www_root&#39;</span><span class="p">:</span> <span class="s1">&#39;http://uat.myapp2.stencel.com/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-53" name="rest_code_dff475444e7244c8ba4ad238bb24105c-53" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-53"></a>        <span class="s1">&#39;retries_before_killing&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-54" name="rest_code_dff475444e7244c8ba4ad238bb24105c-54" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-54"></a>        <span class="s1">&#39;retry_sleep&#39;</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-55" name="rest_code_dff475444e7244c8ba4ad238bb24105c-55" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-55"></a>    <span class="p">},</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-56" name="rest_code_dff475444e7244c8ba4ad238bb24105c-56" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-56"></a>    <span class="s1">&#39;sit&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-57" name="rest_code_dff475444e7244c8ba4ad238bb24105c-57" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-57"></a>        <span class="s1">&#39;envname&#39;</span><span class="p">:</span> <span class="s1">&#39;sit&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-58" name="rest_code_dff475444e7244c8ba4ad238bb24105c-58" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-58"></a>        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;myapp&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-59" name="rest_code_dff475444e7244c8ba4ad238bb24105c-59" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-59"></a>        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;sit.myapp2.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-60" name="rest_code_dff475444e7244c8ba4ad238bb24105c-60" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-60"></a>        <span class="s1">&#39;host_string&#39;</span><span class="p">:</span> <span class="s1">&#39;sit.myapp2.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-61" name="rest_code_dff475444e7244c8ba4ad238bb24105c-61" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-61"></a>        <span class="s1">&#39;key_filename&#39;</span><span class="p">:</span> <span class="s1">&#39;deploy/keys/id_rsa&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-62" name="rest_code_dff475444e7244c8ba4ad238bb24105c-62" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-62"></a>        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;/opt/myapp/sit/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-63" name="rest_code_dff475444e7244c8ba4ad238bb24105c-63" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-63"></a>        <span class="s1">&#39;www_root&#39;</span><span class="p">:</span> <span class="s1">&#39;http://sit.myapp2.stencel.com/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-64" name="rest_code_dff475444e7244c8ba4ad238bb24105c-64" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-64"></a>        <span class="s1">&#39;retries_before_killing&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-65" name="rest_code_dff475444e7244c8ba4ad238bb24105c-65" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-65"></a>        <span class="s1">&#39;retry_sleep&#39;</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-66" name="rest_code_dff475444e7244c8ba4ad238bb24105c-66" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-66"></a>    <span class="p">},</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-67" name="rest_code_dff475444e7244c8ba4ad238bb24105c-67" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-67"></a>    <span class="s1">&#39;live&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-68" name="rest_code_dff475444e7244c8ba4ad238bb24105c-68" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-68"></a>        <span class="s1">&#39;envname&#39;</span><span class="p">:</span> <span class="s1">&#39;live&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-69" name="rest_code_dff475444e7244c8ba4ad238bb24105c-69" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-69"></a>        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;myapp&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-70" name="rest_code_dff475444e7244c8ba4ad238bb24105c-70" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-70"></a>        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;10.10.10.10&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-71" name="rest_code_dff475444e7244c8ba4ad238bb24105c-71" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-71"></a>        <span class="s1">&#39;host_string&#39;</span><span class="p">:</span> <span class="s1">&#39;myapp2.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-72" name="rest_code_dff475444e7244c8ba4ad238bb24105c-72" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-72"></a>        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;/opt/myapp/live/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-73" name="rest_code_dff475444e7244c8ba4ad238bb24105c-73" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-73"></a>        <span class="s1">&#39;www_root&#39;</span><span class="p">:</span> <span class="s1">&#39;http://myapp2.stencel.com/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-74" name="rest_code_dff475444e7244c8ba4ad238bb24105c-74" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-74"></a>        <span class="s1">&#39;retries_before_killing&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-75" name="rest_code_dff475444e7244c8ba4ad238bb24105c-75" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-75"></a>        <span class="s1">&#39;retry_sleep&#39;</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-76" name="rest_code_dff475444e7244c8ba4ad238bb24105c-76" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-76"></a>    <span class="p">},</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-77" name="rest_code_dff475444e7244c8ba4ad238bb24105c-77" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-77"></a>    <span class="s1">&#39;live2&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-78" name="rest_code_dff475444e7244c8ba4ad238bb24105c-78" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-78"></a>        <span class="s1">&#39;envname&#39;</span><span class="p">:</span> <span class="s1">&#39;live2&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-79" name="rest_code_dff475444e7244c8ba4ad238bb24105c-79" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-79"></a>        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-80" name="rest_code_dff475444e7244c8ba4ad238bb24105c-80" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-80"></a>        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;10.10.10.11&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-81" name="rest_code_dff475444e7244c8ba4ad238bb24105c-81" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-81"></a>        <span class="s1">&#39;host_string&#39;</span><span class="p">:</span> <span class="s1">&#39;live2.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-82" name="rest_code_dff475444e7244c8ba4ad238bb24105c-82" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-82"></a>        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/www/myapp/live/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-83" name="rest_code_dff475444e7244c8ba4ad238bb24105c-83" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-83"></a>        <span class="s1">&#39;www_root&#39;</span><span class="p">:</span> <span class="s1">&#39;http://myapp2.stencel.com/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-84" name="rest_code_dff475444e7244c8ba4ad238bb24105c-84" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-84"></a>        <span class="s1">&#39;retries_before_killing&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-85" name="rest_code_dff475444e7244c8ba4ad238bb24105c-85" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-85"></a>        <span class="s1">&#39;retry_sleep&#39;</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-86" name="rest_code_dff475444e7244c8ba4ad238bb24105c-86" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-86"></a>    <span class="p">},</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-87" name="rest_code_dff475444e7244c8ba4ad238bb24105c-87" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-87"></a>    <span class="s1">&#39;live3&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-88" name="rest_code_dff475444e7244c8ba4ad238bb24105c-88" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-88"></a>        <span class="s1">&#39;envname&#39;</span><span class="p">:</span> <span class="s1">&#39;live3&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-89" name="rest_code_dff475444e7244c8ba4ad238bb24105c-89" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-89"></a>        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-90" name="rest_code_dff475444e7244c8ba4ad238bb24105c-90" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-90"></a>        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;10.10.10.12&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-91" name="rest_code_dff475444e7244c8ba4ad238bb24105c-91" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-91"></a>        <span class="s1">&#39;host_string&#39;</span><span class="p">:</span> <span class="s1">&#39;live3.stencel.com&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-92" name="rest_code_dff475444e7244c8ba4ad238bb24105c-92" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-92"></a>        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/www/myapp/live/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-93" name="rest_code_dff475444e7244c8ba4ad238bb24105c-93" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-93"></a>        <span class="s1">&#39;www_root&#39;</span><span class="p">:</span> <span class="s1">&#39;http://myapp2.stencel.com/&#39;</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-94" name="rest_code_dff475444e7244c8ba4ad238bb24105c-94" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-94"></a>        <span class="s1">&#39;retries_before_killing&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-95" name="rest_code_dff475444e7244c8ba4ad238bb24105c-95" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-95"></a>        <span class="s1">&#39;retry_sleep&#39;</span><span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-96" name="rest_code_dff475444e7244c8ba4ad238bb24105c-96" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-96"></a>    <span class="p">},</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-97" name="rest_code_dff475444e7244c8ba4ad238bb24105c-97" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-97"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-98" name="rest_code_dff475444e7244c8ba4ad238bb24105c-98" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-98"></a><span class="p">}</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-99" name="rest_code_dff475444e7244c8ba4ad238bb24105c-99" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-99"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-100" name="rest_code_dff475444e7244c8ba4ad238bb24105c-100" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-100"></a><span class="n">LIVE_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;live&#39;</span><span class="p">,</span> <span class="s1">&#39;live2&#39;</span><span class="p">,</span> <span class="s1">&#39;live3&#39;</span><span class="p">]</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-101" name="rest_code_dff475444e7244c8ba4ad238bb24105c-101" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-101"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-102" name="rest_code_dff475444e7244c8ba4ad238bb24105c-102" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-102"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-103" name="rest_code_dff475444e7244c8ba4ad238bb24105c-103" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-103"></a><span class="k">def</span><span class="w"> </span><span class="nf">list_hosts</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-104" name="rest_code_dff475444e7244c8ba4ad238bb24105c-104" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-104"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-105" name="rest_code_dff475444e7244c8ba4ad238bb24105c-105" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-105"></a><span class="sd">    Lists available myapp hosts</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-106" name="rest_code_dff475444e7244c8ba4ad238bb24105c-106" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-106"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-107" name="rest_code_dff475444e7244c8ba4ad238bb24105c-107" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-107"></a>    <span class="nb">print</span> <span class="s2">&quot; Single hosts(if you want to pull from svn only to one of them):&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-108" name="rest_code_dff475444e7244c8ba4ad238bb24105c-108" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-108"></a>    <span class="nb">print</span> <span class="s1">&#39;   </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">   &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">SERVERS</span><span class="p">])</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-109" name="rest_code_dff475444e7244c8ba4ad238bb24105c-109" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-109"></a>    <span class="nb">print</span> <span class="s2">&quot; Multiple hosts&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-110" name="rest_code_dff475444e7244c8ba4ad238bb24105c-110" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-110"></a>    <span class="nb">print</span> <span class="s1">&#39;   live (which contains </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">LIVE_HOSTS</span><span class="p">])</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-111" name="rest_code_dff475444e7244c8ba4ad238bb24105c-111" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-111"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-112" name="rest_code_dff475444e7244c8ba4ad238bb24105c-112" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-112"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-113" name="rest_code_dff475444e7244c8ba4ad238bb24105c-113" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-113"></a><span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-114" name="rest_code_dff475444e7244c8ba4ad238bb24105c-114" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-114"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-115" name="rest_code_dff475444e7244c8ba4ad238bb24105c-115" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-115"></a><span class="sd">    single host definition , &quot;fab test restart&quot; wil restart this one host</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-116" name="rest_code_dff475444e7244c8ba4ad238bb24105c-116" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-116"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-117" name="rest_code_dff475444e7244c8ba4ad238bb24105c-117" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-118" name="rest_code_dff475444e7244c8ba4ad238bb24105c-118" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-118"></a>    <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-119" name="rest_code_dff475444e7244c8ba4ad238bb24105c-119" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-119"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-120" name="rest_code_dff475444e7244c8ba4ad238bb24105c-120" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-120"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-121" name="rest_code_dff475444e7244c8ba4ad238bb24105c-121" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-121"></a><span class="k">def</span><span class="w"> </span><span class="nf">localhost</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-122" name="rest_code_dff475444e7244c8ba4ad238bb24105c-122" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-123" name="rest_code_dff475444e7244c8ba4ad238bb24105c-123" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-123"></a><span class="sd">    single host definition , &quot;fab test restart&quot; wil restart this one host</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-124" name="rest_code_dff475444e7244c8ba4ad238bb24105c-124" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-124"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-125" name="rest_code_dff475444e7244c8ba4ad238bb24105c-125" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-125"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-126" name="rest_code_dff475444e7244c8ba4ad238bb24105c-126" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-126"></a>    <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="s1">&#39;local&#39;</span><span class="p">]))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-127" name="rest_code_dff475444e7244c8ba4ad238bb24105c-127" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-127"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-128" name="rest_code_dff475444e7244c8ba4ad238bb24105c-128" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-128"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-129" name="rest_code_dff475444e7244c8ba4ad238bb24105c-129" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-129"></a><span class="k">def</span><span class="w"> </span><span class="nf">uat</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-130" name="rest_code_dff475444e7244c8ba4ad238bb24105c-130" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-130"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-131" name="rest_code_dff475444e7244c8ba4ad238bb24105c-131" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-131"></a><span class="sd">    single host definition , &quot;fab uat restart&quot; wil restart this single host</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-132" name="rest_code_dff475444e7244c8ba4ad238bb24105c-132" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-132"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-133" name="rest_code_dff475444e7244c8ba4ad238bb24105c-133" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-133"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-134" name="rest_code_dff475444e7244c8ba4ad238bb24105c-134" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-134"></a>    <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="s1">&#39;uat&#39;</span><span class="p">]))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-135" name="rest_code_dff475444e7244c8ba4ad238bb24105c-135" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-135"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-136" name="rest_code_dff475444e7244c8ba4ad238bb24105c-136" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-136"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-137" name="rest_code_dff475444e7244c8ba4ad238bb24105c-137" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-137"></a><span class="k">def</span><span class="w"> </span><span class="nf">sit</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-138" name="rest_code_dff475444e7244c8ba4ad238bb24105c-138" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-138"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-139" name="rest_code_dff475444e7244c8ba4ad238bb24105c-139" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-139"></a><span class="sd">    single host</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-140" name="rest_code_dff475444e7244c8ba4ad238bb24105c-140" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-140"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-141" name="rest_code_dff475444e7244c8ba4ad238bb24105c-141" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-141"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-142" name="rest_code_dff475444e7244c8ba4ad238bb24105c-142" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-142"></a>    <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="s1">&#39;sit&#39;</span><span class="p">]))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-143" name="rest_code_dff475444e7244c8ba4ad238bb24105c-143" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-143"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-144" name="rest_code_dff475444e7244c8ba4ad238bb24105c-144" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-144"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-145" name="rest_code_dff475444e7244c8ba4ad238bb24105c-145" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-145"></a><span class="c1">#  SERVERS GRcompanyS DEFINITION</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-146" name="rest_code_dff475444e7244c8ba4ad238bb24105c-146" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-146"></a><span class="k">def</span><span class="w"> </span><span class="nf">live</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-147" name="rest_code_dff475444e7244c8ba4ad238bb24105c-147" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-147"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-148" name="rest_code_dff475444e7244c8ba4ad238bb24105c-148" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-148"></a><span class="sd">    multiple grcompany of hosts - running: &quot;fab live restart&quot; will restart all live servers</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-149" name="rest_code_dff475444e7244c8ba4ad238bb24105c-149" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-149"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-150" name="rest_code_dff475444e7244c8ba4ad238bb24105c-150" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-150"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-151" name="rest_code_dff475444e7244c8ba4ad238bb24105c-151" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-151"></a>    <span class="n">env</span><span class="p">[</span><span class="s1">&#39;hosts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">SERVERS</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">LIVE_HOSTS</span><span class="p">]</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-152" name="rest_code_dff475444e7244c8ba4ad238bb24105c-152" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-152"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-153" name="rest_code_dff475444e7244c8ba4ad238bb24105c-153" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-153"></a>    <span class="c1"># env.update(dict(SERVERS[&#39;staging&#39;]))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-154" name="rest_code_dff475444e7244c8ba4ad238bb24105c-154" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-154"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-155" name="rest_code_dff475444e7244c8ba4ad238bb24105c-155" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-155"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-156" name="rest_code_dff475444e7244c8ba4ad238bb24105c-156" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-156"></a><span class="k">def</span><span class="w"> </span><span class="nf">env_update</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-157" name="rest_code_dff475444e7244c8ba4ad238bb24105c-157" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-157"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-158" name="rest_code_dff475444e7244c8ba4ad238bb24105c-158" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-158"></a><span class="sd">    Decorator - needs to be added to each task in fabricfile - for multiple host task execution</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-159" name="rest_code_dff475444e7244c8ba4ad238bb24105c-159" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-159"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-160" name="rest_code_dff475444e7244c8ba4ad238bb24105c-160" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-160"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-161" name="rest_code_dff475444e7244c8ba4ad238bb24105c-161" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-161"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">func_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-162" name="rest_code_dff475444e7244c8ba4ad238bb24105c-162" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-162"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">hosts</span><span class="p">):</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-163" name="rest_code_dff475444e7244c8ba4ad238bb24105c-163" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-163"></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-164" name="rest_code_dff475444e7244c8ba4ad238bb24105c-164" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-164"></a>        <span class="k">else</span><span class="p">:</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-165" name="rest_code_dff475444e7244c8ba4ad238bb24105c-165" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-165"></a>            <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">SERVERS</span><span class="p">[</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">SERVERS</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">env</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">MyApp_SERVERS</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-166" name="rest_code_dff475444e7244c8ba4ad238bb24105c-166" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-166"></a>            <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-167" name="rest_code_dff475444e7244c8ba4ad238bb24105c-167" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-167"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-168" name="rest_code_dff475444e7244c8ba4ad238bb24105c-168" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-168"></a>    <span class="k">return</span> <span class="n">func_wrapper</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-169" name="rest_code_dff475444e7244c8ba4ad238bb24105c-169" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-169"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-170" name="rest_code_dff475444e7244c8ba4ad238bb24105c-170" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-170"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-171" name="rest_code_dff475444e7244c8ba4ad238bb24105c-171" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-171"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-172" name="rest_code_dff475444e7244c8ba4ad238bb24105c-172" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-172"></a><span class="k">def</span><span class="w"> </span><span class="nf">bundle_media</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-173" name="rest_code_dff475444e7244c8ba4ad238bb24105c-173" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-173"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-174" name="rest_code_dff475444e7244c8ba4ad238bb24105c-174" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-174"></a><span class="sd">    bundles media like css and js to one file.</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-175" name="rest_code_dff475444e7244c8ba4ad238bb24105c-175" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-175"></a><span class="sd">    example:</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-176" name="rest_code_dff475444e7244c8ba4ad238bb24105c-176" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-176"></a><span class="sd">        fab test bundle_media</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-177" name="rest_code_dff475444e7244c8ba4ad238bb24105c-177" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-177"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-178" name="rest_code_dff475444e7244c8ba4ad238bb24105c-178" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-178"></a>    <span class="c1"># export DJANGO_SETTINGS_MODULE=settings</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-179" name="rest_code_dff475444e7244c8ba4ad238bb24105c-179" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-179"></a>    <span class="c1">#run(&quot;cd {0} &amp;&amp; source settings/{1}-config.sh &amp;&amp; python scripts/bundle_media.py&quot;.format(env.path,env.envname))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-180" name="rest_code_dff475444e7244c8ba4ad238bb24105c-180" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-180"></a>   <span class="n">run</span><span class="p">(</span><span class="s2">&quot;source /usr/share/virtualenvwrapper/virtualenvwrapper.sh &amp;&amp; workon </span><span class="si">{0}</span><span class="s2"> &amp;&amp; python scripts/bundle_media.py&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-myapp&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span> <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">&lt;&gt;</span> <span class="s1">&#39;live&#39;</span> <span class="k">else</span> <span class="s1">&#39;MyApp-test&#39;</span><span class="p">))</span> <span class="c1">#change live venv to be live-MyApp</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-181" name="rest_code_dff475444e7244c8ba4ad238bb24105c-181" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-181"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-182" name="rest_code_dff475444e7244c8ba4ad238bb24105c-182" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-182"></a><span class="k">def</span><span class="w"> </span><span class="nf">_valid_branch</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-183" name="rest_code_dff475444e7244c8ba4ad238bb24105c-183" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-183"></a>    <span class="n">branch</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="s2">&quot;cd </span><span class="si">{0}</span><span class="s2"> &amp;&amp; git rev-parse --abbrev-ref HEAD&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-184" name="rest_code_dff475444e7244c8ba4ad238bb24105c-184" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-184"></a>    <span class="k">return</span> <span class="n">branch</span> <span class="o">==</span> <span class="n">SERVER_BRANCHES</span><span class="p">[</span><span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">==</span><span class="s1">&#39;local&#39;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-185" name="rest_code_dff475444e7244c8ba4ad238bb24105c-185" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-185"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-186" name="rest_code_dff475444e7244c8ba4ad238bb24105c-186" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-186"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-187" name="rest_code_dff475444e7244c8ba4ad238bb24105c-187" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-187"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-188" name="rest_code_dff475444e7244c8ba4ad238bb24105c-188" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-188"></a><span class="k">def</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-189" name="rest_code_dff475444e7244c8ba4ad238bb24105c-189" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-189"></a>    <span class="k">if</span> <span class="n">_valid_branch</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-190" name="rest_code_dff475444e7244c8ba4ad238bb24105c-190" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-190"></a>        <span class="k">with</span> <span class="n">cd</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-191" name="rest_code_dff475444e7244c8ba4ad238bb24105c-191" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-191"></a>            <span class="n">run</span><span class="p">(</span><span class="s2">&quot;git fetch origin&quot;</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-192" name="rest_code_dff475444e7244c8ba4ad238bb24105c-192" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-192"></a>            <span class="n">run</span><span class="p">(</span><span class="s2">&quot;git reset --hard origin/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">branch</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-193" name="rest_code_dff475444e7244c8ba4ad238bb24105c-193" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-193"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-194" name="rest_code_dff475444e7244c8ba4ad238bb24105c-194" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-194"></a>        <span class="nb">print</span> <span class="s2">&quot;Error : Server is checked out to wrong branch!!!&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-195" name="rest_code_dff475444e7244c8ba4ad238bb24105c-195" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-195"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-196" name="rest_code_dff475444e7244c8ba4ad238bb24105c-196" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-196"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-197" name="rest_code_dff475444e7244c8ba4ad238bb24105c-197" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-197"></a>            <span class="c1">#run(&#39;git fetch --quiet&#39;)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-198" name="rest_code_dff475444e7244c8ba4ad238bb24105c-198" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-198"></a>            <span class="c1">#run(&#39;git fetch --tags --quiet&#39;)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-199" name="rest_code_dff475444e7244c8ba4ad238bb24105c-199" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-199"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-200" name="rest_code_dff475444e7244c8ba4ad238bb24105c-200" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-200"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-201" name="rest_code_dff475444e7244c8ba4ad238bb24105c-201" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-201"></a><span class="k">def</span><span class="w"> </span><span class="nf">reload</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-202" name="rest_code_dff475444e7244c8ba4ad238bb24105c-202" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-202"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-203" name="rest_code_dff475444e7244c8ba4ad238bb24105c-203" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-203"></a><span class="sd">    Reload specified servers - kills unused gunicorn workers but waits workers with old code to finish processing.</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-204" name="rest_code_dff475444e7244c8ba4ad238bb24105c-204" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-204"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-205" name="rest_code_dff475444e7244c8ba4ad238bb24105c-205" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-205"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-206" name="rest_code_dff475444e7244c8ba4ad238bb24105c-206" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-206"></a>    <span class="n">bundle_media</span><span class="p">()</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-207" name="rest_code_dff475444e7244c8ba4ad238bb24105c-207" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-207"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-208" name="rest_code_dff475444e7244c8ba4ad238bb24105c-208" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-208"></a>    <span class="c1">#if env.envname in (&#39;uat&#39;, &#39;staging&#39;, &#39;live&#39;):</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-209" name="rest_code_dff475444e7244c8ba4ad238bb24105c-209" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-209"></a>    <span class="n">f</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-210" name="rest_code_dff475444e7244c8ba4ad238bb24105c-210" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-210"></a>    <span class="n">get</span><span class="p">(</span><span class="s2">&quot;/opt/myapp/</span><span class="si">%s</span><span class="s2">/pid&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-211" name="rest_code_dff475444e7244c8ba4ad238bb24105c-211" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-211"></a>    <span class="n">pid</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span><span class="n">f</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-212" name="rest_code_dff475444e7244c8ba4ad238bb24105c-212" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-212"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;ps aux | grep gunicorn | grep </span><span class="si">%s</span><span class="s2"> | grep master | grep -v grep | awk &#39;{print $2}&#39;&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-213" name="rest_code_dff475444e7244c8ba4ad238bb24105c-213" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-213"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;kill -HUP </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pid</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-214" name="rest_code_dff475444e7244c8ba4ad238bb24105c-214" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-214"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-215" name="rest_code_dff475444e7244c8ba4ad238bb24105c-215" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-215"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-216" name="rest_code_dff475444e7244c8ba4ad238bb24105c-216" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-216"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-217" name="rest_code_dff475444e7244c8ba4ad238bb24105c-217" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-217"></a><span class="k">def</span><span class="w"> </span><span class="nf">restart</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-218" name="rest_code_dff475444e7244c8ba4ad238bb24105c-218" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-218"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-219" name="rest_code_dff475444e7244c8ba4ad238bb24105c-219" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-219"></a><span class="sd">    Hard restarts specified servers</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-220" name="rest_code_dff475444e7244c8ba4ad238bb24105c-220" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-220"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-221" name="rest_code_dff475444e7244c8ba4ad238bb24105c-221" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-221"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-222" name="rest_code_dff475444e7244c8ba4ad238bb24105c-222" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-222"></a>    <span class="n">bundle_media</span><span class="p">()</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-223" name="rest_code_dff475444e7244c8ba4ad238bb24105c-223" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-223"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;ps aux | grep gunicorn | grep </span><span class="si">%s</span><span class="s2"> | grep master | grep -v grep | awk &#39;{print $2}&#39;&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-224" name="rest_code_dff475444e7244c8ba4ad238bb24105c-224" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-224"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;supervisorctl stop myapp-</span><span class="si">%s</span><span class="s2"> &amp;&amp; supervisorctl start MyApp-</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">,</span><span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">))</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-225" name="rest_code_dff475444e7244c8ba4ad238bb24105c-225" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-225"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;ps aux | grep gunicorn | grep </span><span class="si">%s</span><span class="s2"> | grep master | grep -v grep | awk &#39;{print $2}&#39;&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-226" name="rest_code_dff475444e7244c8ba4ad238bb24105c-226" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-226"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-227" name="rest_code_dff475444e7244c8ba4ad238bb24105c-227" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-227"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-228" name="rest_code_dff475444e7244c8ba4ad238bb24105c-228" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-228"></a><span class="k">def</span><span class="w"> </span><span class="nf">help</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-229" name="rest_code_dff475444e7244c8ba4ad238bb24105c-229" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-229"></a>    <span class="n">fabric_functions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;run&#39;</span><span class="p">,</span> <span class="s1">&#39;execute&#39;</span><span class="p">,</span> <span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="s1">&#39;func_wrapper&#39;</span><span class="p">]</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-230" name="rest_code_dff475444e7244c8ba4ad238bb24105c-230" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-230"></a>    <span class="n">functions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fabric_functions</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-231" name="rest_code_dff475444e7244c8ba4ad238bb24105c-231" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-231"></a>                     <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">])</span> <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">obj</span><span class="p">)])</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-232" name="rest_code_dff475444e7244c8ba4ad238bb24105c-232" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-232"></a>    <span class="n">functions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-233" name="rest_code_dff475444e7244c8ba4ad238bb24105c-233" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-233"></a>    <span class="nb">print</span> <span class="s2">&quot;usage: </span><span class="se">\n</span><span class="s2">  fab [host/grcompany of hosts] [commands] (optional command with arguments command:kwarg=val,arg1,arg2,arg3)&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-234" name="rest_code_dff475444e7244c8ba4ad238bb24105c-234" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-234"></a>    <span class="nb">print</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">available servers:&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-235" name="rest_code_dff475444e7244c8ba4ad238bb24105c-235" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-235"></a>    <span class="n">list_hosts</span><span class="p">()</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-236" name="rest_code_dff475444e7244c8ba4ad238bb24105c-236" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-236"></a>    <span class="nb">print</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">commands:</span><span class="se">\n</span><span class="s2">  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">])</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-237" name="rest_code_dff475444e7244c8ba4ad238bb24105c-237" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-237"></a>    <span class="nb">print</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">examples:</span><span class="se">\n</span><span class="s2">  staging svnxapp:app=holdings_and_quotes,layout.py,permissions.py restart&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-238" name="rest_code_dff475444e7244c8ba4ad238bb24105c-238" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-238"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab test restart&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-239" name="rest_code_dff475444e7244c8ba4ad238bb24105c-239" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-239"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab staging svnxapp:app=holdings_and_quotes,lib/quote.py,layout.py,models.py&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-240" name="rest_code_dff475444e7244c8ba4ad238bb24105c-240" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-240"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab staging svnxapp:app=holdings_and_quotes,lib/quote.py restart&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-241" name="rest_code_dff475444e7244c8ba4ad238bb24105c-241" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-241"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab test build&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-242" name="rest_code_dff475444e7244c8ba4ad238bb24105c-242" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-242"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab test bundle_media restart&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-243" name="rest_code_dff475444e7244c8ba4ad238bb24105c-243" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-243"></a>    <span class="nb">print</span> <span class="s2">&quot; For svnx whole app (comma in the end):&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-244" name="rest_code_dff475444e7244c8ba4ad238bb24105c-244" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-244"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab test svnxapp:app=medrep,&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-245" name="rest_code_dff475444e7244c8ba4ad238bb24105c-245" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-245"></a>    <span class="nb">print</span> <span class="s2">&quot; For global lib:&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-246" name="rest_code_dff475444e7244c8ba4ad238bb24105c-246" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-246"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab test svnxlib&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-247" name="rest_code_dff475444e7244c8ba4ad238bb24105c-247" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-247"></a>    <span class="nb">print</span> <span class="s2">&quot; For whole global media:&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-248" name="rest_code_dff475444e7244c8ba4ad238bb24105c-248" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-248"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab test svnxmedia:&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-249" name="rest_code_dff475444e7244c8ba4ad238bb24105c-249" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-249"></a>    <span class="nb">print</span> <span class="s2">&quot; For global media file:&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-250" name="rest_code_dff475444e7244c8ba4ad238bb24105c-250" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-250"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab test svnxmedia:javascript&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-251" name="rest_code_dff475444e7244c8ba4ad238bb24105c-251" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-251"></a>    <span class="nb">print</span> <span class="s2">&quot;  fab test svnxmedia:javascript/company/checklist.js&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-252" name="rest_code_dff475444e7244c8ba4ad238bb24105c-252" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-252"></a>    <span class="nb">print</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">If .js file in args like : fab staging svnxapp:app=holdings_and_quotes,media/js/quote.js,layout.py,models.py&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-253" name="rest_code_dff475444e7244c8ba4ad238bb24105c-253" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-253"></a>    <span class="nb">print</span> <span class="s2">&quot;It will bundle media itself&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-254" name="rest_code_dff475444e7244c8ba4ad238bb24105c-254" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-254"></a>    <span class="nb">print</span> <span class="s2">&quot;Restart test staging without params:</span><span class="se">\n</span><span class="s2">  fab restart&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-255" name="rest_code_dff475444e7244c8ba4ad238bb24105c-255" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-255"></a>    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-256" name="rest_code_dff475444e7244c8ba4ad238bb24105c-256" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-256"></a>        <span class="nb">print</span> <span class="n">f</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-257" name="rest_code_dff475444e7244c8ba4ad238bb24105c-257" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-257"></a>        <span class="nb">print</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="vm">__doc__</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-258" name="rest_code_dff475444e7244c8ba4ad238bb24105c-258" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-258"></a>        <span class="nb">print</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-259" name="rest_code_dff475444e7244c8ba4ad238bb24105c-259" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-259"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-260" name="rest_code_dff475444e7244c8ba4ad238bb24105c-260" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-260"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-261" name="rest_code_dff475444e7244c8ba4ad238bb24105c-261" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-261"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-262" name="rest_code_dff475444e7244c8ba4ad238bb24105c-262" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-262"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-263" name="rest_code_dff475444e7244c8ba4ad238bb24105c-263" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-263"></a><span class="k">def</span><span class="w"> </span><span class="nf">accessguni</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-264" name="rest_code_dff475444e7244c8ba4ad238bb24105c-264" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-264"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;tail /var/log/myapp/access-</span><span class="si">%s</span><span class="s2">.log&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-265" name="rest_code_dff475444e7244c8ba4ad238bb24105c-265" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-265"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-266" name="rest_code_dff475444e7244c8ba4ad238bb24105c-266" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-266"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-267" name="rest_code_dff475444e7244c8ba4ad238bb24105c-267" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-267"></a><span class="k">def</span><span class="w"> </span><span class="nf">accessgunilive</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-268" name="rest_code_dff475444e7244c8ba4ad238bb24105c-268" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-268"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;tail -f /var/log/myapp/access-</span><span class="si">%s</span><span class="s2">.log&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-269" name="rest_code_dff475444e7244c8ba4ad238bb24105c-269" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-269"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-270" name="rest_code_dff475444e7244c8ba4ad238bb24105c-270" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-270"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-271" name="rest_code_dff475444e7244c8ba4ad238bb24105c-271" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-271"></a><span class="k">def</span><span class="w"> </span><span class="nf">errorguni</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-272" name="rest_code_dff475444e7244c8ba4ad238bb24105c-272" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-272"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;tail /var/log/myapp/error-</span><span class="si">%s</span><span class="s2">.log&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-273" name="rest_code_dff475444e7244c8ba4ad238bb24105c-273" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-273"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-274" name="rest_code_dff475444e7244c8ba4ad238bb24105c-274" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-274"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-275" name="rest_code_dff475444e7244c8ba4ad238bb24105c-275" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-275"></a><span class="k">def</span><span class="w"> </span><span class="nf">errorgunilive</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-276" name="rest_code_dff475444e7244c8ba4ad238bb24105c-276" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-276"></a>    <span class="n">run</span><span class="p">(</span><span class="s2">&quot;tail -f /var/log/myapp/error.log&quot;</span> <span class="o">%</span> <span class="n">env</span><span class="o">.</span><span class="n">envname</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-277" name="rest_code_dff475444e7244c8ba4ad238bb24105c-277" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-277"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-278" name="rest_code_dff475444e7244c8ba4ad238bb24105c-278" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-278"></a><span class="k">def</span><span class="w"> </span><span class="nf">hostname</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-279" name="rest_code_dff475444e7244c8ba4ad238bb24105c-279" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-279"></a>    <span class="n">run</span><span class="p">(</span><span class="s1">&#39;uname -a&#39;</span><span class="p">)</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-280" name="rest_code_dff475444e7244c8ba4ad238bb24105c-280" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-280"></a>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-281" name="rest_code_dff475444e7244c8ba4ad238bb24105c-281" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-281"></a><span class="nd">@env_update</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-282" name="rest_code_dff475444e7244c8ba4ad238bb24105c-282" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-282"></a><span class="k">def</span><span class="w"> </span><span class="nf">uptime</span><span class="p">():</span>
<a id="rest_code_dff475444e7244c8ba4ad238bb24105c-283" name="rest_code_dff475444e7244c8ba4ad238bb24105c-283" href="#rest_code_dff475444e7244c8ba4ad238bb24105c-283"></a>    <span class="n">run</span><span class="p">(</span><span class="s1">&#39;uptime&#39;</span><span class="p">)</span>
</pre></div>
